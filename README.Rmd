---
title: hydroscoper
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-"
)
```

[![Travis-CI Build Status](https://travis-ci.org/kvantas/hydroscoper.svg?branch=master)](https://travis-ci.org/kvantas/hydroscoper)
[![AppVeyor Build Status](https://ci.appveyor.com/api/projects/status/github/kvantas/hydroscoper?branch=master&svg=true)](https://ci.appveyor.com/project/kvantas/hydroscoper)
[![codecov](https://codecov.io/github/kvantas/hydroscoper/branch/master/graphs/badge.svg)](https://codecov.io/gh/kvantas/hydroscoper) 
[![DOI](https://zenodo.org/badge/114094911.svg)](https://zenodo.org/badge/latestdoi/114094911)

`hydroscoper` is an R interface to the  Greek National Databank for Hydrological and Meteorological Information, [Hydroscope](<http://www.hydroscope.gr/>). It covers most of Hydroscope's sources and provides functions to transform these untidy data sets into tidy dataframes.

The Hydroscope's data sets are in Greek, thus limiting their usefulness. `hydroscoper` transliterates the Greek Unicode text to Latin, and translates various Greek terms to English.

## Data sources in hydroscoper
 
 * Ministry of Environment and Energy, http://kyy.hydroscope.gr/ 
 * Ministry of Rural Development and Food, http://ypaat.hydroscope.gr/
 * National Meteorological Service, http://emy.hydroscope.gr/

The front end for the data sources of Greek Public Power Corporation, http://deh.hydroscope.gr/, uses an old format and it is not currently supported.

Note that only the two Ministries allow to download time series values freely.
 
## Installation

You can install the development version from GitHub with:

```{r gh-installation, eval = FALSE}
# install.packages("devtools")
devtools::install_github("kvantas/hydroscoper")
```


## Using hydroscoper

The available functions that are provided by `hydroscoper` are:

* `get_stations` to retrieve a tidy dataframe with stations' data for a given data source.
* `get_coords` to retrieve the coordinates and elevation for a given station.
* `get_timeseries` to retriece a tidy dataframe with a station's time series. 
* `get_data` to retriece a tidy dataframe with a time series' values.

## Example

This is a basic example which shows you how to get a dataframe with stations from the Ministry of Environment and Energy:

```{r get_stations}
library(hydroscoper)
stations <- get_stations(subdomain = "kyy")
head(stations[c("StationID", "WaterDivisionID", "Name", "Owner", "Type")])
```

Using the above data you can get the coordinates and the elevation for a specific station, **200251**:

```{r get_coords}
crds <-  get_coords(subdomain = "kyy", stationID = 200251)
crds
```

To get the time series from the same station run:

```{r get_time_series}

ts_data <- get_timeseries(subdomain = "kyy", stationID = 200251)
ts_data[c("TimeSeriesID", "Variable", "TimeStep", "Unit", "StartDate","EndDate")]
```

You can get the time series **912** to a tidy dataframe with:
```{r get_data}
df <- get_data(subdomain = "kyy", timeID = 912)
```

Let's create a plot for these data:
```{r plot_timeseries}
suppressPackageStartupMessages(library(ggplot2))
ggplot(data = df, aes(x = Date, y = Value))+
  geom_line()+
  labs(title="Dailly rainfall data for station 200251",
       x="Date", y = "Rain (mm)")+
  theme_classic()

```

## Meta

* Please [report any issues or bugs](https://github.com/kvantas/hydroscoper/issues).
* Licence:
    + All code is licenced MIT
    + All data are from the public data sources in http://www.hydroscope.gr/

## References
[Hydroscope](http://www.hydroscope.gr/)
